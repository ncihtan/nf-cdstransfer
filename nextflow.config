profiles {
    local {
        process.executor = 'local'
        docker.enabled = true
    }

    docker {
        docker.enabled = true
    }

    tower {
        docker.enabled = true
        process {
            cpus = { 1 * task.attempt }
            memory = { 1.GB * task.attempt }
            maxRetries = 3
            errorStrategy = 'retry'
        }
    }

    test {
        process.executor = 'local'
        docker.enabled = true
        params.input = 'samplesheet.csv'   // Only provide input for test profile
        params.dryrun = true
        params.aws_secret_prefix = 'TEST'
    }

    cds {
        params.aws_secret_prefix = 'CDS'
        docker.enabled = true
    }
}

params{
    dryrun = false
    take_n = -1
}

// Consolidate plugins into a single block
plugins {
    id 'nf-schema@2.2.0'
    id 'nf-boost'
}

boost {
    cleanup = true
}

trace {
    enabled = true
    overwrite = true
    file = 'reports/trace.csv'
    sep = ','
    fields = 'task_id,hash,native_id,name,status,exit,submit,duration,realtime,%cpu,peak_rss,peak_vmem,rchar,wchar'
}

docker.enabled = true