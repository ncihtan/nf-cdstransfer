{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/samplesheet.schema.json",
  "title": "Samplesheet Schema",
  "description": "Schema for validating rows in a CSV samplesheet.",
  "type": "array",
  "items": {
    "type": "object",
    "required": ["entityId", "file_name"],
    "additionalProperties": true,

    "properties": {
      "entityId": {
        "type": "string",
        "pattern": "^syn\\d+$",
        "description": "Synapse entity ID starting with 'syn' followed by digits.",
        "examples": ["syn123456"],
        "meta": ["entityid", "entity_id"]
      },

      "file_name": {
        "type": "string",
        "minLength": 1,
        "description": "Filename as it should appear in the metadata TSV.",
        "meta": ["Filename", "name"]
      },

      "file_type": {
        "type": "string",
        "description": "Logical file type (e.g., BAM, FASTQ, TSV).",
        "meta": ["File_Type"]
      },

      "file_description": {
        "type": "string",
        "description": "Free-text description of the file.",
        "meta": ["File_Description"]
      },

      "file_size": {
        "description": "File size in bytes (string or integer).",
        "oneOf": [
          { "type": "integer", "minimum": 0 },
          { "type": "string", "pattern": "^[0-9]+$" }
        ],
        "meta": ["File_Size"]
      },

      "md5sum": {
        "type": "string",
        "description": "MD5 checksum (32 hex chars).",
        "pattern": "^[A-Fa-f0-9]{32}$",
        "meta": ["MD5", "checksum_md5"]
      },

      "experimental_strategy_and_data_subtypes": {
        "type": "string",
        "description": "Experimental strategy / data subtype value expected by CRDC.",
        "meta": ["experimental_strategy", "Experimental_Strategy"]
      },

      "submission_version": {
        "type": "string",
        "description": "Submission version label/tag.",
        "meta": ["Submission_Version"]
      },

      "checksum_value": {
        "type": "string",
        "description": "External checksum value if using a non-MD5 workflow.",
        "meta": ["Checksum_Value"]
      },

      "checksum_algorithm": {
        "type": "string",
        "description": "Checksum algorithm name.",
        "enum": ["md5", "sha1", "sha256", "sha512", "none"],
        "default": "md5",
        "meta": ["Checksum_Algorithm"]
      },

      "file_mapping_level": {
        "type": "string",
        "description": "Mapping level (e.g., Level1/Level2/etc. if applicable).",
        "meta": ["File_Mapping_Level"]
      },

      "release_datetime": {
        "type": "string",
        "description": "ISO-8601 datetime of release (e.g., 2025-08-28T12:34:56Z).",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}([Tt ]\\d{2}:\\d{2}(:\\d{2})?(Z|[+-]\\d{2}:?\\d{2})?)?$",
        "meta": ["Release_Datetime"]
      },

      "is_supplementary_file": {
        "description": "Whether this is a supplementary file (boolean or common string forms).",
        "oneOf": [
          { "type": "boolean" },
          { "type": "string", "enum": ["true", "false", "TRUE", "FALSE", "yes", "no", "YES", "NO", "0", "1"] }
        ],
        "meta": ["Is_Supplementary_File"]
      },

      "study_phs_accession": {
        "type": "string",
        "description": "e.g., phs002371",
        "pattern": "^phs\\d{6,}$",
        "default": "phs002371",
        "meta": ["study.phs_accession", "phs_accession"]
      },

      "study_participant_id": {
        "type": "string",
        "description": "Participant study_participant_id (e.g., phs002371_HTA10_XXXX).",
        "meta": ["participant.study_participant_id", "study_participant_id"]
      },

      "sample_id": {
        "type": "string",
        "description": "Sample ID (e.g., HTA10_04_109 or assay biospecimen ID).",
        "meta": ["sample.sample_id", "HTAN_Assayed_Biospecimen_ID"]
      }
    }
  },

  "examples": [
    [
      {
        "entityId": "syn68779614",
        "file_name": "A002C213.sorted.ir.br.rmDup.md.bam",
        "file_type": "BAM",
        "file_description": "Aligned reads",
        "file_size": "23080470105",
        "md5sum": "d41d8cd98f00b204e9800998ecf8427e",
        "experimental_strategy_and_data_subtypes": "WES Aligned Reads",
        "submission_version": "v1",
        "checksum_value": "",
        "checksum_algorithm": "md5",
        "file_mapping_level": "Level2",
        "release_datetime": "2025-08-28T00:00:00Z",
        "is_supplementary_file": "false",
        "study_phs_accession": "phs002371",
        "study_participant_id": "phs002371_HTA10_04_109",
        "sample_id": "HTA10_04_109"
      }
    ]
  ]
}
